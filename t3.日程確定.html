<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æ—¥ç¨‹ç¢ºå®šï¼ˆã‚¢ãƒç¢ºå®šï¼‰</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>

<h3>æ—¥ç¨‹ç¢ºå®šï¼ˆã‚¢ãƒç¢ºå®šï¼‰</h3>

<!-- CSVã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ -->
<input type="file" id="csvFile" accept=".csv">
<hr>

<!-- å…¥åŠ›æ¬„ -->
<label>LINEåï¼š
  <input type="text" id="lineName" rows="1" cols="50" placeholder="å…¥åŠ›å¿…é ˆ" style="background-color:#fff9c4;">
  <button type="button" id="lineNameCopyBtn">ã‚³ãƒ”ãƒ¼</button>
</label><br>

<label>é¢è«‡æ—¥ç¨‹ï¼š
  <input type="text" id="meetingDate" rows="1" cols="50" placeholder="å…¥åŠ›å¿…é ˆ" style="background-color:#e8f5e9;">
</label><br>

<label>ãƒ¡ãƒ¢ï¼š
  <input type="text" id="source" rows="1" cols="50" placeholder="">
</label><br>
<hr>

<!-- ã‚„ã‚‹ã“ã¨è¡¨ç¤º -->
<p>çµ¶å¯¾ã‚„ã‚‹ã“ã¨</p>
<ul>
  <li><a href="https://docs.google.com/spreadsheets/d/1-jGXpUpUrfIHLbBuzeydGdYYr9v_J6QKynJKtLC5L7w/edit?gid=2079834522#gid=2079834522">ã‚¯ãƒ­ãƒ¼ã‚¶ãƒ¼æ—¥ç¨‹</a>ã«è¨˜å…¥</li>
  <li>ï¼§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«å…¥åŠ› (â€»ãƒ¡ãƒ¼ãƒ«é€ä¿¡å¿˜ã‚Œãšã«ï¼)</li>
  <li><a href="https://docs.google.com/spreadsheets/d/1-jGXpUpUrfIHLbBuzeydGdYYr9v_J6QKynJKtLC5L7w/edit?gid=82785762#gid=82785762">å€‹åˆ¥ç›¸è«‡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹(åºƒå‘Š)</a>ã«è¨˜å…¥</li>
</ul>
<hr>

<p>UTAGEç”»é¢</p>
<ul>
  <li>ãƒ†ãƒ³ãƒ—ãƒ¬é€ä¿¡ã‚ˆã‚Š<span style="color:red;">ã€æœ€æ–°ç‰ˆã€‘æ—¥ç¨‹ç¢ºå®šç›´å¾Œé€ä»˜</span> ã‚’é€ä¿¡</li>
  <li>Zoomãƒªãƒ³ã‚¯é€ä¿¡</li>
  <li>é›‘è«‡ã‚¹ã‚¿ãƒ¼ãƒˆ</li>
  <li>ï¼’ã¤ãƒ©ãƒ™ãƒ«ã‚’è²¼ã‚‹<br>
    <span style="font-weight:bold; background:yellow;">â­•æ—¥ç¨‹ç¢ºå®šï¼ˆæ™®é€šå°ç·šï¼‰</span><br>
    <span style="font-weight:bold; background:yellow;">æ‹…å½“è€…å</span>
  </li>
  <li>ãƒ¡ã‚¤ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã€ã‚µãƒãƒ¼ãƒˆç”³è¾¼æ¸ˆã€ãƒ©ãƒ™ãƒ«è²¼ã‚‹</li>
</ul>
<hr>

<!-- Zoomãƒªãƒ³ã‚¯é€ä¿¡ç”¨ -->
<label>æ‹…å½“è€…ï¼š<br>
  <select id="staffSelect">
    <option value="">CSVã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„</option>
  </select>
</label><br><br>

<textarea id="output" rows="10" cols="50"></textarea>
<button id="copyBtn">ã‚³ãƒ”ãƒ¼</button>

<!-- é›‘è«‡è³ªå• -->
<textarea id="extraQuestion" rows="3" cols="50"></textarea>
<button id="extraCopyBtn">ã‚³ãƒ”ãƒ¼</button>

<script>
const csvFileInput = document.getElementById("csvFile");

const lineNameInput = document.getElementById("lineName");
const lineNameCopyBtn = document.getElementById("lineNameCopyBtn");
const sourceInput = document.getElementById("source");
const meetingDateInput = document.getElementById("meetingDate");

const staffSelect = document.getElementById("staffSelect");
const output = document.getElementById("output");

const extraQuestion = document.getElementById("extraQuestion");
const extraCopyBtn = document.getElementById("extraCopyBtn");

let staffData = {};

// CSVèª­ã¿è¾¼ã¿
csvFileInput.addEventListener("change", function(e){
    const file = e.target.files[0];
    if(!file) return;

    Papa.parse(file, {
        header: false,
        skipEmptyLines: true,
        complete: function(results){
            staffData = {};
            staffSelect.innerHTML = '<option value="">æ‹…å½“è€…ã‚’é¸æŠ</option>';

            results.data.forEach(row => {
                const name = row[0]?.trim();
                const url = row[1]?.trim();
                if(name && url){
                    staffData[name] = url;
                    const opt = document.createElement("option");
                    opt.value = name;
                    opt.textContent = name;
                    staffSelect.appendChild(opt);
                }
            });
        }
    });
});

// LINEåãƒ»é¢è«‡æ—¥å…¥åŠ›æ™‚
lineNameInput.addEventListener("input", function(){
    const name = lineNameInput.value.trim();
    staffSelect.value = "";
    sourceInput.value = "";
    meetingDateInput.value = "";
    output.value = "";

    // é›‘è«‡è³ªå•ç”Ÿæˆ
    extraQuestion.value = name ? `${name}ã•ã‚“ã¯ã“ã‚Œã¾ã§å‰¯æ¥­ã‚„ã£ãŸã“ã¨ã‚ã‚Šã¾ã™ã‹ï¼ŸğŸ˜Šâœ¨` : "";
});

// LINEåã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³
lineNameCopyBtn.addEventListener("click", function(){
    if(!lineNameInput.value.trim()) return;
    lineNameInput.select();
    lineNameInput.setSelectionRange(0, 99999);
    document.execCommand("copy");
});

// ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³é¸æŠæ™‚ã«Zoomãƒªãƒ³ã‚¯ç”Ÿæˆ
staffSelect.addEventListener("change", function(){
    const name = staffSelect.value;
    if(!name){
        output.value = "";
        return;
    }

    if(!lineNameInput.value.trim() || !meetingDateInput.value.trim()){
        alert("LINEåã¨é¢è«‡æ—¥ç¨‹ã¯å¿…é ˆã§ã™ã€‚å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
        staffSelect.value = "";
        output.value = "";
        return;
    }
    const zoomUrl = staffData[name];
    const dateStr = meetingDateInput.value;

    output.value = `å®Ÿæ–½æ—¥ï¼š${dateStr}\n\n${zoomUrl}\n\nã€ç„¡æ–™ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã¯ã“ã¡ã‚‰ğŸ‘‡ã€‘\nhttps://forms.gle/i2XPWLVQE44iYc7b8`;
});

// å‡ºåŠ›ã‚³ãƒ”ãƒ¼
document.getElementById("copyBtn").addEventListener("click", function(){
    if(!output.value.trim()) return;
    output.select();
    output.setSelectionRange(0, 99999);
    document.execCommand("copy");
});

// é›‘è«‡ã‚³ãƒ”ãƒ¼
extraCopyBtn.addEventListener("click", function(){
    if(!extraQuestion.value.trim()) return;
    extraQuestion.select();
    extraQuestion.setSelectionRange(0, 99999);
    document.execCommand("copy");
});
</script>

</body>
</html>
