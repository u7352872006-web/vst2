<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>å½“æ—¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä»˜</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>

<h3>å½“æ—¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä»˜ğŸŒ</h3>

<!-- CSVä½œã‚Šæ–¹ãƒªãƒ³ã‚¯ -->
<a
  href="https://www.loom.com/share/206c56f599f84ba1aed34ff241102d75"
  target="_blank"
  style="font-size:8pt; display:inline-block; margin-bottom:6px;"
>
  ğŸ’¡ CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œã‚Šæ–¹
</a>
<br>
<span style="font-size:8pt; color:#d32f2f;">
  â€» æœ€æ–°ç‰ˆã®ã‚¯ãƒ­ãƒ¼ã‚¶ãƒ¼Zoomãƒªãƒ³ã‚¯CSVã‚’ã”ç”¨æ„ãã ã•ã„ï¼
</span>
<br>

<input type="file" id="csvFile" accept=".csv">
<hr>

<label>
  æ‹…å½“è€…ï¼š
  <select id="staffSelect">
    <option value="">CSVã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„</option>
  </select>
</label>
<br>
<br>

<textarea id="output" rows="15" cols="27" style="background:#f9f9f9;"></textarea>
<br>
<button id="copyBtn">ã‚³ãƒ”ãƒ¼</button>

<script>
const csvFileInput = document.getElementById("csvFile");
const staffSelect = document.getElementById("staffSelect");
const output = document.getElementById("output");
const copyBtn = document.getElementById("copyBtn");

let staffData = {};

// ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
function generateText() {
  const staffName = staffSelect.value;

  if (!staffName) {
    output.value = "";
    return;
  }

  output.value =
`ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™â˜€ï¸

æœ¬æ—¥ã®Zoomã¯ã“ã¡ã‚‰ã§ã™ï¼
æ™‚é–“ã«ãªã£ãŸã‚‰å…¥å®¤ã—ã¦ãã ã•ã„ğŸ˜Š

${staffData[staffName]}`;
}

// CSVèª­ã¿è¾¼ã¿
csvFileInput.addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  staffSelect.innerHTML = '<option value="">æ‹…å½“è€…ã‚’é¸æŠ</option>';
  staffData = {};

  Papa.parse(file, {
    header: false,
    skipEmptyLines: true,
    complete: results => {
      results.data.forEach(row => {
        const name = row[0]?.trim();
        const url = row[1]?.trim();
        if (name && url) {
          staffData[name] = url;
          staffSelect.insertAdjacentHTML(
            "beforeend",
            `<option value="${name}">${name}</option>`
          );
        }
      });
    }
  });
});

// æ‹…å½“è€…å¤‰æ›´æ™‚ã«ç”Ÿæˆ
staffSelect.addEventListener("change", generateText);

// ã‚³ãƒ”ãƒ¼
copyBtn.addEventListener("click", () => {
  if (!output.value.trim()) return;
  output.select();
  document.execCommand("copy");
});
</script>

</body>
</html>


