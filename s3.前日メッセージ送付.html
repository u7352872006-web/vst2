<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>å‰æ—¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä»˜</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>

<h3>å‰æ—¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä»˜</h3>

<input type="file" id="csvFile" accept=".csv">
<hr>

<label>
  é¢è«‡æ™‚é–“:
  <select id="meetingTime">
    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
    <option value="10:00">10:00</option>
    <option value="11:30">11:30</option>
    <option value="13:00">13:00</option>
    <option value="14:30">14:30</option>
    <option value="16:00">16:00</option>
    <option value="17:30">17:30</option>
    <option value="18:30">18:30</option>
    <option value="19:00">19:00</option>
    <option value="20:30">20:30</option>
    <option value="21:00">21:00</option>
    <option value="21:30">21:30</option>
    <option value="22:00">22:00</option>
  </select>
</label><br><br>

<label>
  æ‹…å½“è€…ï¼š
  <select id="staffSelect">
    <option value="">CSVã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„</option>
  </select>
</label><br><br>

<label>
  ç”Ÿæˆãƒ†ã‚­ã‚¹ãƒˆï¼ˆç·¨é›†ãƒ»ã‚³ãƒ”ãƒ¼å¯ï¼‰:<br>
  <textarea id="output" rows="20" cols="26" style="background:#f9f9f9;"></textarea>
</label>
<br>
<button id="copyBtn">ã‚³ãƒ”ãƒ¼</button>

<script>
const csvFileInput = document.getElementById("csvFile");
const meetingTimeInput = document.getElementById("meetingTime");
const staffSelect = document.getElementById("staffSelect");
const output = document.getElementById("output");
const copyBtn = document.getElementById("copyBtn");

let staffData = {};

// ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
function generateText() {
  const staffName = staffSelect.value;
  const time = meetingTimeInput.value;

  if (!staffName || !time) {
    output.value = "";
    return;
  }

  output.value =
`ãŠç–²ã‚Œæ§˜ã§ã™ï¼
æ˜æ—¥ã®${time}ã‹ã‚‰ã¯äºˆå®šé€šã‚Šã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ğŸ˜Š

æ™‚é–“ã«ãªã£ãŸã‚‰ã”å‚åŠ ãã ã•ã„ã€‚

${staffData[staffName]}`;
}

// CSVèª­ã¿è¾¼ã¿
csvFileInput.addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;

  staffSelect.innerHTML = '<option value="">æ‹…å½“è€…ã‚’é¸æŠ</option>';
  staffData = {};

  Papa.parse(file, {
    header: false,
    skipEmptyLines: true,
    complete: results => {
      results.data.forEach(row => {
        const name = row[0]?.trim();
        const url = row[1]?.trim();
        if (name && url) {
          staffData[name] = url;
          staffSelect.insertAdjacentHTML(
            "beforeend",
            `<option value="${name}">${name}</option>`
          );
        }
      });
    }
  });
});

// æ‹…å½“è€…å¤‰æ›´
staffSelect.addEventListener("change", generateText);

// é¢è«‡æ™‚é–“å¤‰æ›´
meetingTimeInput.addEventListener("change", generateText);

// ã‚³ãƒ”ãƒ¼
copyBtn.addEventListener("click", () => {
  if (!output.value.trim()) return;
  output.select();
  document.execCommand("copy");
});
</script>

</body>
</html>


