<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>面談日程選択</title>
</head>
<body>

<h2>面談日程選択</h2>

<label>日付：</label>
<input type="date" id="interviewDate">
<br><br>

<label>開始時刻：</label>
<select id="startTime"></select>
<br><br>

<button id="generateBtn">生成</button>
<br><br>

<label>出力：</label>
<textarea id="outputText" rows="1" cols="30" readonly></textarea>
<button onclick="copyText('outputText')">コピー</button>

<script>
// コピー機能（アラートなし）
function copyText(id){
    const ta = document.getElementById(id);
    if(!ta.value.trim()) return;
    ta.select();
    ta.setSelectionRange(0, 99999);
    document.execCommand("copy");
}

// 時間選択肢を30分刻みで生成（8:00〜23:00）
const startTimeSelect = document.getElementById("startTime");
for(let h=8; h<=23; h++){
    ["00","30"].forEach(min=>{
        if(h === 23 && min === "30") return; // 23:30は終了24:30になるので除外
        const timeStr = `${h.toString().padStart(2,"0")}:${min}`;
        const option = document.createElement("option");
        option.value = timeStr;
        option.textContent = timeStr;
        startTimeSelect.appendChild(option);
    });
}

// 前回選択日を保持
let lastSelectedDate = "";

// 日付変更時にリセット
document.getElementById("interviewDate").addEventListener("change", ()=>{
    const currentDate = document.getElementById("interviewDate").value;
    if(lastSelectedDate && currentDate !== lastSelectedDate){
        startTimeSelect.selectedIndex = 0;
        document.getElementById("outputText").value = "";
    }
    lastSelectedDate = currentDate;
});

// 生成処理
document.getElementById("generateBtn").addEventListener("click", ()=>{
    const dateInput = document.getElementById("interviewDate").value;
    const startTime = document.getElementById("startTime").value;

    if(!dateInput || !startTime){
        alert("日付と開始時刻を選択してください");
        return;
    }

    const dateObj = new Date(dateInput);
    const weekDays = ["日","月","火","水","木","金","土"];
    const weekDay = weekDays[dateObj.getDay()];

    // 終了時刻は開始時刻の1時間後
    let [h, m] = startTime.split(":").map(Number);
    h += 1;
    if(h >= 24) h -= 24; // 24時を超えた場合は0時に戻す
    const endTime = `${h.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`;

    // 出力区切り「～」
    const formattedDate = `${dateObj.getMonth()+1}/${dateObj.getDate()}(${weekDay}) ${startTime}～${endTime}`;

    document.getElementById("outputText").value = formattedDate;
});
</script>

</body>
</html>
