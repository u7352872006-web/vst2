<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>2.ã‚¢ãƒç¢ºå®š</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>

<h3>2.ã‚¢ãƒç¢ºå®š</h3>

<input type="file" id="csvFile" accept=".csv">
<p id="fileName">CSVã‚’é¸æŠã—ã¦ãã ã•ã„</p>
<hr>

<label>LINEåï¼ˆå¿…é ˆï¼‰: 
  <input type="text" id="lineName">
  <button type="button" id="lineNameCopyBtn">ã‚³ãƒ”ãƒ¼</button>
</label><br>
<label>æµå…¥çµŒè·¯ï¼ˆå¿…é ˆï¼‰: <input type="text" id="source"></label><br>
<label>é¢è«‡æ—¥ï¼ˆå¿…é ˆï¼‰: <input type="text" id="meetingDate"></label><br>
<hr>

<p>â‘  ã‚¯ãƒ­ãƒ¼ã‚¶ãƒ¼æ—¥ç¨‹</p>
<hr>

<p>â‘¡ ï¼§ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ ã€å‹•ç”»ç·¨é›†ï¼ _LINEåã€æ™‚é–“90åˆ†ã€æ‹…å½“è€…ã€‘</p>
<p>è£œè¶³ ãƒ¡ãƒ¼ãƒ«é€ä¿¡</p>
<hr>

<p style="color:blue;">â‘¢ å€‹åˆ¥ç›¸è«‡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹(åºƒå‘Š)ã«è¨˜å…¥</p>
<hr>

<p style="color:red;">â‘£-1 ãƒ†ãƒ³ãƒ—ãƒ¬é€ä¿¡ ã€æœ€æ–°ç‰ˆã€‘æ—¥ç¨‹ç¢ºå®šç›´å¾Œé€ä»˜</p>
<hr>

<p>â‘£-2 Zoomãƒªãƒ³ã‚¯é€ä¿¡</p>
<label>æ‹…å½“è€…ï¼š
<select id="staffSelect">
  <option value="">CSVã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„</option>
</select>
</label><br><br>

<label>ç”Ÿæˆãƒ†ã‚­ã‚¹ãƒˆï¼ˆã‚³ãƒ”ãƒ¼å¯ï¼‰:<br>
<textarea id="output" rows="13" cols="60" readonly style="background:#f0f0f0;"></textarea>
</label>
<button id="copyBtn">ã‚³ãƒ”ãƒ¼</button>
<hr>

<!-- â˜… æ–°è¦è¿½åŠ ï¼šè³ªå•ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ -->
<p>â‘£-3 è¿½åŠ è³ªå•ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰</p>
<label>è¿½åŠ è³ªå•ï¼ˆã‚³ãƒ”ãƒ¼å¯ï¼‰:<br>
<textarea id="extraQuestion" rows="3" cols="60" readonly style="background:#f0f0f0;"></textarea>
</label>
<button id="extraCopyBtn">ã‚³ãƒ”ãƒ¼</button>
<hr>

<p style="color:blue;">â‘¤ ãƒ¡ã‚¤ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€â˜…ã‚µãƒãƒ¼ãƒˆç”³è¾¼æ¸ˆã€‘</p>
<hr>

<p style="color:red;">â‘¥ ãƒ©ãƒ™ãƒ«ãƒ»ãƒ¡ãƒ¢</p>
<p>æ—¥ç¨‹èª¿æ•´ä¸­ğŸ”µâ†’æ¶ˆã™  æ—¥ç¨‹ç¢ºå®šï¼ˆæ™®é€šå°ç·šï¼‰</p>
<p>æ‹…å½“è€…</p>
<p>æ—¥ç¨‹ck</p>
<hr>

<p>â‘¦ Slackã€Œåºƒå‘Šã‚»ãƒ¼ãƒ«ã‚¹ã€ã§å ±å‘Š</p>
<p>æ‹…å½“ã‚»ãƒ¼ãƒ«ã‚¹ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³</p>
<p>ã‚¹ã‚¯ã‚·ãƒ§</p>

<!-- â˜… Slackç”¨ã‚¹ãƒ¬ãƒƒãƒ‰åç”Ÿæˆ -->
<label>ã€Slackç”¨ã€‘ã‚¢ãƒæŒ¯ã‚Šã‚¹ãƒ¬ãƒƒãƒ‰å:<br>
<textarea id="slackOutput" rows="2" cols="60" readonly style="background:#f0f0f0;"></textarea>
</label>
<button id="slackCopyBtn">ã‚³ãƒ”ãƒ¼</button>

<hr>

<script>
const csvFileInput = document.getElementById("csvFile");
const fileNameDisplay = document.getElementById("fileName");

const lineNameInput = document.getElementById("lineName");
const lineNameCopyBtn = document.getElementById("lineNameCopyBtn");
const sourceInput = document.getElementById("source");
const meetingDateInput = document.getElementById("meetingDate");

const staffSelect = document.getElementById("staffSelect");
const output = document.getElementById("output");

const extraQuestion = document.getElementById("extraQuestion");
const extraCopyBtn = document.getElementById("extraCopyBtn");

const slackOutput = document.getElementById("slackOutput");
const slackCopyBtn = document.getElementById("slackCopyBtn");

let staffData = {};

// CSVèª­ã¿è¾¼ã¿
csvFileInput.addEventListener("change", function(e){
    const file = e.target.files[0];
    if(!file) return;
    fileNameDisplay.textContent = "èª­ã¿è¾¼ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«: " + file.name;

    Papa.parse(file, {
        header: false,
        skipEmptyLines: true,
        complete: function(results){
            staffData = {};
            staffSelect.innerHTML = '<option value="">æ‹…å½“è€…ã‚’é¸æŠ</option>';
            results.data.forEach(row => {
                const name = row[0]?.trim();
                const url = row[1]?.trim();
                if(name && url){
                    staffData[name] = url;
                    const opt = document.createElement("option");
                    opt.value = name;
                    opt.textContent = name;
                    staffSelect.appendChild(opt);
                }
            });
        }
    });
});

// LINEåãŒå¤‰ã‚ã£ãŸã‚‰åˆæœŸåŒ– + Slackåç”Ÿæˆ + è³ªå•æ–‡ç”Ÿæˆ
lineNameInput.addEventListener("input", function(){
    const name = lineNameInput.value.trim();

    staffSelect.value = "";
    sourceInput.value = "";
    meetingDateInput.value = "";
    output.value = "";

    // Slackã‚¹ãƒ¬ãƒƒãƒ‰å
    slackOutput.value = name ? `ã€${name}ï¼¿ã‚¢ãƒæŒ¯ã‚Šã‚¹ãƒ¬ãƒƒãƒ‰ã€‘` : "";

    // æ–°è¦è¿½åŠ ï¼šè³ªå•æ–‡ç”Ÿæˆ
    extraQuestion.value = name ? `${name}ã•ã‚“ã¯ã“ã‚Œã¾ã§å‰¯æ¥­ã‚„ã£ãŸã“ã¨ã‚ã‚Šã¾ã™ã‹ï¼Ÿ` : "";
});

// LINEåã‚³ãƒ”ãƒ¼
lineNameCopyBtn.addEventListener("click", function(){
    if(!lineNameInput.value.trim()) return;
    lineNameInput.select();
    lineNameInput.setSelectionRange(0, 99999);
    document.execCommand("copy");
});

// ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³é¸æŠæ™‚
staffSelect.addEventListener("change", function(){
    const name = staffSelect.value;
    if(!name){
        output.value = "";
        return;
    }

    if(!lineNameInput.value.trim() || !sourceInput.value.trim() || !meetingDateInput.value.trim()){
        alert("LINEåãƒ»æµå…¥çµŒè·¯ãƒ»é¢è«‡æ—¥ã‚’ã™ã¹ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
        staffSelect.value = "";
        output.value = "";
        return;
    }

    const zoomUrl = staffData[name];
    const dateStr = meetingDateInput.value;

    output.value = `å®Ÿæ–½æ—¥ï¼š${dateStr}\n\n${zoomUrl}\n\nã€ç„¡æ–™ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã¯ã“ã¡ã‚‰ğŸ‘‡ã€‘\nhttps://forms.gle/i2XPWLVQE44iYc7b8`;
});

// å‡ºåŠ›ã‚³ãƒ”ãƒ¼
copyBtn.addEventListener("click", function(){
    if(!output.value.trim()) return;
    output.select();
    output.setSelectionRange(0, 99999);
    document.execCommand("copy");
});

// è¿½åŠ è³ªå•ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³
extraCopyBtn.addEventListener("click", function(){
    if(!extraQuestion.value.trim()) return;
    extraQuestion.select();
    extraQuestion.setSelectionRange(0, 99999);
    document.execCommand("copy");
});

// Slackåã‚³ãƒ”ãƒ¼
slackCopyBtn.addEventListener("click", function(){
    if(!slackOutput.value.trim()) return;
    slackOutput.select();
    slackOutput.setSelectionRange(0, 99999);
    document.execCommand("copy");
});
</script>

</body>
</html>